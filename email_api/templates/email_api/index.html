{% load static %}
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Play & Learn ‚Äî Kodikids</title>
  <link rel="stylesheet" href="{% static 'email_api/css/style.css' %}">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>">
</head>
<body>
  <header>
    {% include "email_api/_header.html" %}

  <main class="container" id="main">
    <section class="hero" aria-labelledby="hero-title">
      <div class="hero-background">
        <h1 id="hero-title" data-lang-key="heroTitle">Apprenez √† coder et piloter des robots ‚Äî enfants & adultes</h1>
        <p id="hero-lead" data-lang-key="heroLead">Parcours ludiques et ateliers pratiques : programmation, IA, jeux √©ducatifs et robotique.</p>
        <p style="margin-top:14px"><a class="cta" href="/api/start/" data-lang-key="heroCTA">Commencer</a></p>
      </div>

      <div class="hero-canvas-wrapper" aria-hidden="false" style="flex:1">
        <div class="hero-decor-bg" aria-hidden="true"></div>
        <canvas id="hero-canvas" role="img" aria-label="Animation de points connect√©s"></canvas>

        <div class="hero-overlay" aria-hidden="false">
          <h2 id="rotating-title" style="margin:0;font-size:20px;opacity:1">Robot & IA Learning</h2>
          <p id="rotating-sub" style="margin:8px 0 0;color:var(--muted)" data-lang-key="rotatingSub">Projets visuels et interactifs pour tous.</p>
        </div>
      </div>
    </section>

    <div class="container">
      <h2>Nos fonctionnalit√©s</h2>
      <div class="carousel">
        <div class="carousel-track">
          <div class="carousel-item">
            <img src="https://via.placeholder.com/300x200/2b7cff/ffffff?text=Code" alt="Apprendre √† coder">
            <h3 data-lang-key="carouselTitle1">Apprendre √† coder</h3>
            <p data-lang-key="carouselDesc1">Parcours ludiques et ateliers pas √† pas.</p>
          </div>
          <div class="carousel-item">
            <img src="https://via.placeholder.com/300x200/7af0b3/0b1724?text=IA" alt="IA pour tous">
            <h3 data-lang-key="carouselTitle2">IA pour tous</h3>
            <p data-lang-key="carouselDesc2">Initiation aux concepts d'IA avec projets visuels.</p>
          </div>
          <div class="carousel-item">
            <img src="https://via.placeholder.com/300x200/ff7a7a/ffffff?text=Robots" alt="Robots et jeux">
            <h3 data-lang-key="carouselTitle3">Robots et jeux</h3>
            <p data-lang-key="carouselDesc3">Programmez des robots et apprenez en jouant.</p>
          </div>
          <div class="carousel-item">
            <img src="https://via.placeholder.com/300x200/7af0b3/0b1724?text=IA" alt="IA pour tous">
            <h3 data-lang-key="carouselTitle4">Communication</h3>
            <p data-lang-key="carouselDesc4">Pr√©sentez vos projets et communiquez vos id√©es.</p>
          </div>
          <div class="carousel-item">
            <img src="https://via.placeholder.com/300x200/ff7a7a/ffffff?text=Robots" alt="Robots et jeux">
            <h3 data-lang-key="carouselTitle5">Carri√®re Tech</h3>
            <p data-lang-key="carouselDesc5">Pr√©parez-vous pour les m√©tiers du num√©rique.</p>
          </div>
        </div>
        <button class="carousel-btn prev" aria-label="Pr√©c√©dent">&#10094;</button>
        <button class="carousel-btn next" aria-label="Suivant">&#10095;</button>
      </div>
    </div>

    <section class="cards" aria-label="programmes">
      <!-- card 1 -->
      <div class="card flip" tabindex="0" aria-labelledby="card1-title">
        <div class="card-inner">
          <div class="card-face card-front" aria-hidden="false">
            <h3 id="card1-title" data-lang-key="card1Title">Apprendre √† coder</h3>
            <p data-lang-key="card1Desc">Ateliers pas √† pas adapt√©s aux d√©butants et aux enfants.</p>
          </div>
          <div class="card-face card-back" aria-hidden="true">
            <h3 data-lang-key="card1BackTitle">Programmer avec</h3>
            <p data-lang-key="card1BackDesc">JavaScript, Python & Scratch</p>
          </div>
        </div>
      </div>

      <!-- card 2 (flip) -->
      <div class="card flip" tabindex="0" aria-labelledby="card2-title">
        <div class="card-inner">
          <div class="card-face card-front" aria-hidden="false">
            <h3 id="card2-title" data-lang-key="card2Title">IA pour tous</h3>
            <p data-lang-key="card2Desc">Initiation aux concepts d'IA avec projets simples et visuels.</p>
          </div>
          <div class="card-face card-back" aria-hidden="true">
            <h3 data-lang-key="card2BackTitle">Atelier IA</h3>
            <p data-lang-key="card2BackDesc">Mini-projets ML visuels ‚Äî Python, notebooks & TinyML</p>
          </div>
        </div>
      </div>

      <!-- card 3 (flip) -->
      <div class="card flip" tabindex="0" aria-labelledby="card3-title">
        <div class="card-inner">
          <div class="card-face card-front" aria-hidden="false">
            <h3 id="card3-title" data-lang-key="card3Title">Robots et jeux</h3>
            <p data-lang-key="card3Desc">Programmez des robots et apprenez en jouant.</p>
          </div>
          <div class="card-face card-back" aria-hidden="true">
            <h3 data-lang-key="card3BackTitle">D√©fis robotiques</h3>
            <p data-lang-key="card3BackDesc">Construisez des missions: Arduino, Blockly et challenges interactifs</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="cookie-banner" class="cookie-banner">
    <p data-lang-key="cookieText">Nous n'utilisons pas de cookies de suivi. En cliquant sur "Accepter", vous acceptez notre politique de confidentialit√©.</p>
    <button id="cookie-accept-btn" class="cookie-accept-btn" data-lang-key="cookieAccept">Accepter</button>
  </div>

  <footer>
    <div class="container">
      <span data-lang-key="footerText">¬© Play & Learn ‚Äî Enseignement de la programmation, des robots et de l'IA</span>
    </div>
  </footer>

  <script>
  (function(){
    // Particle + linking animation inside hero canvas
    const wrapper = document.querySelector('.hero-canvas-wrapper');
    const canvas = document.getElementById('hero-canvas');
    if(!wrapper || !canvas) return;
    const ctx = canvas.getContext('2d');
    let DPR = Math.max(1, window.devicePixelRatio || 1);
    const COLORS = ['#2b7cff','#ff7a7a','#7af0b3','#f0d36a'];
    let particles = [];
    const MAX_DIST = 140;

    function resize(){
      DPR = Math.max(1, window.devicePixelRatio || 1);
      const w = Math.max(200, Math.floor(wrapper.clientWidth));
      const h = Math.max(120, Math.floor(wrapper.clientHeight));
      canvas.width = Math.floor(w * DPR);
      canvas.height = Math.floor(h * DPR);
      canvas.style.width = w + 'px';
      canvas.style.height = h + 'px';
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }

    function rand(min,max){ return Math.random()*(max-min)+min; }

    function initParticles(){
      particles = [];
      const W = wrapper.clientWidth, H = wrapper.clientHeight;
      const count = Math.min(60, Math.max(18, Math.round(W/35)));
      for(let i=0;i<count;i++){
        particles.push({
          x: rand(0,W),
          y: rand(0,H),
          vx: rand(-0.5,0.5),
          vy: rand(-0.5,0.5),
          r: rand(2.2,4.6),
          c: COLORS[i % COLORS.length]
        });
      }
    }

    let mouse = {x:-9999,y:-9999,active:false};
    wrapper.addEventListener('mousemove', function(e){
      const r = wrapper.getBoundingClientRect();
      mouse.x = e.clientX - r.left;
      mouse.y = e.clientY - r.top;
      mouse.active = true;
    });
    wrapper.addEventListener('touchmove', function(e){
      const r = wrapper.getBoundingClientRect();
      const t = e.touches[0];
      if(t){ mouse.x = t.clientX - r.left; mouse.y = t.clientY - r.top; mouse.active = true; }
    }, {passive:true});
    wrapper.addEventListener('mouseleave', function(){ mouse.active=false; mouse.x=-9999; mouse.y=-9999; });
    window.addEventListener('resize', function(){ resize(); initParticles(); });

    function hexToRgba(hex,a){
      const h = hex.replace('#','');
      const bigint = parseInt(h,16);
      const r = (bigint >> 16) & 255;
      const g = (bigint >> 8) & 255;
      const b = bigint & 255;
      return 'rgba('+r+','+g+','+b+','+(a||1)+')';
    }

    function step(){
      const W = wrapper.clientWidth, H = wrapper.clientHeight;
      ctx.clearRect(0,0,W,H);

      // update
      for(let p of particles){
        p.x += p.vx;
        p.y += p.vy;
        if(p.x < 0 || p.x > W) p.vx *= -1;
        if(p.y < 0 || p.y > H) p.vy *= -1;
        if(mouse.active){
          const dx = p.x - mouse.x, dy = p.y - mouse.y;
          const d = Math.sqrt(dx*dx + dy*dy);
          if(d < 80 && d > 0){
            p.vx += (dx/d)*0.03;
            p.vy += (dy/d)*0.03;
          }
        }
      }

      // draw lines
      for(let i=0;i<particles.length;i++){
        for(let j=i+1;j<particles.length;j++){
          const a = particles[i], b = particles[j];
          const dx = a.x - b.x, dy = a.y - b.y;
          const d = Math.sqrt(dx*dx + dy*dy);
          if(d < MAX_DIST){
            const alpha = 1 - d / MAX_DIST;
            ctx.beginPath();
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
            const grad = ctx.createLinearGradient(a.x,a.y,b.x,b.y);
            grad.addColorStop(0, hexToRgba(a.c, 0.9*alpha));
            grad.addColorStop(1, hexToRgba(b.c, 0.9*alpha));
            ctx.strokeStyle = grad;
            ctx.lineWidth = 0.8 + alpha*1.2;
            ctx.stroke();
          }
        }
      }

      // draw points
      for(let p of particles){
        ctx.beginPath();
        ctx.fillStyle = p.c;
        ctx.globalAlpha = 0.95;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();
        ctx.globalAlpha = 1;
      }

      requestAnimationFrame(step);
    }

    // init
    resize();
    initParticles();
    requestAnimationFrame(step);
  })();
  </script>

  <script>
  (function(){
    // rotating title: Robot & IA Learning -> Play and Learning -> Coding games
    const titles = ['Robot & IA Learning', 'Play and Learning', 'Coding games'];
    const el = document.getElementById('rotating-title');
    if(!el) return;
    let idx = 0;
    const interval = 2600;
    function showNext(){
      el.style.opacity = '0';
      setTimeout(()=>{
        idx = (idx + 1) % titles.length;
        el.textContent = titles[idx];
        el.style.opacity = '1';
      }, 420);
    }
    // start after a short delay
    setTimeout(()=>{ setInterval(showNext, interval); }, interval);
  })();
  </script>

  <script>
  (function(){
    const track = document.querySelector('.carousel-track');
    if (!track) return;

    const items = track.querySelectorAll('.carousel-item');
    const prevBtn = document.querySelector('.carousel-btn.prev');
    const nextBtn = document.querySelector('.carousel-btn.next');
    let index = 0;

    function getVisibleItems() {
      if (window.innerWidth >= 900) return 3;
      if (window.innerWidth >= 600) return 2;
      return 1;
    }

    function updateCarousel() {
      const itemWidth = items[0].offsetWidth;
      const gap = parseInt(window.getComputedStyle(track).gap) || 16;
      track.style.transform = `translateX(-${index * (itemWidth + gap)}px)`;
      prevBtn.style.display = index === 0 ? 'none' : 'flex';
      nextBtn.style.display = index >= items.length - getVisibleItems() ? 'none' : 'flex';
    }

    nextBtn.addEventListener('click', () => { if (index < items.length - getVisibleItems()) { index++; updateCarousel(); } });
    prevBtn.addEventListener('click', () => { if (index > 0) { index--; updateCarousel(); } });
    window.addEventListener('resize', updateCarousel);
    updateCarousel(); // Initial call
  })();
  </script>

  <script>
  (function() {
    // Language switcher logic
    const langSwitcher = document.getElementById('lang-switcher');
    if (!langSwitcher) return;

    const translations = {
      en: {
        heroTitle: "Learn to code and control robots ‚Äî for kids & adults",
        heroLead: "Fun learning paths and hands-on workshops: programming, AI, educational games, and robotics.",
        heroCTA: "Get Started",
        rotatingSub: "Visual and interactive projects for everyone.",
        carouselTitle1: "Learn to Code",
        carouselDesc1: "Fun tracks and step-by-step workshops.",
        carouselTitle2: "AI for Everyone",
        carouselDesc2: "Introduction to AI concepts with visual projects.",
        carouselTitle3: "Robots and Games",
        carouselDesc3: "Program robots and learn by playing.",
        carouselTitle4: "Communication",
        carouselDesc4: "Present your projects and share your ideas.",
        carouselTitle5: "Tech Career",
        carouselDesc5: "Get ready for digital-age jobs.",
        card1Title: "Learn to Code",
        card1Desc: "Step-by-step workshops for beginners and kids.",
        card1BackTitle: "Code with",
        card1BackDesc: "JavaScript, Python & Scratch",
        card2Title: "AI for Everyone",
        card2Desc: "Introduction to AI concepts with simple, visual projects.",
        card2BackTitle: "AI Workshop",
        card2BackDesc: "Visual ML mini-projects ‚Äî Python, notebooks & TinyML",
        card3Title: "Robots and Games",
        card3Desc: "Program robots and learn through play.",
        card3BackTitle: "Robotics Challenges",
        card3BackDesc: "Build missions: Arduino, Blockly, and interactive challenges",
        footerText: "¬© Play & Learn ‚Äî Teaching programming, robotics, and AI",
        cookieText: "We do not use tracking cookies. By clicking 'Accept', you agree to our privacy policy.",
        cookieAccept: "Accept"
      },
      fr: {
        heroTitle: "Apprenez √† coder et piloter des robots ‚Äî enfants & adultes",
        heroLead: "Parcours ludiques et ateliers pratiques : programmation, IA, jeux √©ducatifs et robotique.",
        heroCTA: "Commencer",
        rotatingSub: "Projets visuels et interactifs pour tous.",
        carouselTitle1: "Apprendre √† coder",
        carouselDesc1: "Parcours ludiques et ateliers pas √† pas.",
        carouselTitle2: "IA pour tous",
        carouselDesc2: "Initiation aux concepts d'IA avec projets visuels.",
        carouselTitle3: "Robots et jeux",
        carouselDesc3: "Programmez des robots et apprenez en jouant.",
        carouselTitle4: "Communication",
        carouselDesc4: "Pr√©sentez vos projets et communiquez vos id√©es.",
        carouselTitle5: "Carri√®re Tech",
        carouselDesc5: "Pr√©parez-vous pour les m√©tiers du num√©rique.",
        card1Title: "Apprendre √† coder",
        card1Desc: "Ateliers pas √† pas adapt√©s aux d√©butants et aux enfants.",
        card1BackTitle: "Programmer avec",
        card1BackDesc: "JavaScript, Python & Scratch",
        card2Title: "IA pour tous",
        card2Desc: "Initiation aux concepts d'IA avec projets simples et visuels.",
        card2BackTitle: "Atelier IA",
        card2BackDesc: "Mini-projets ML visuels ‚Äî Python, notebooks & TinyML",
        card3Title: "Robots et jeux",
        card3Desc: "Programmez des robots et apprenez en jouant.",
        card3BackTitle: "D√©fis robotiques",
        card3BackDesc: "Construisez des missions: Arduino, Blockly et challenges interactifs",
        footerText: "¬© Play & Learn ‚Äî Enseignement de la programmation, des robots et de l'IA",
        cookieText: "Nous n'utilisons pas de cookies de suivi. En cliquant sur 'Accepter', vous acceptez notre politique de confidentialit√©.",
        cookieAccept: "Accepter"
      }
    };

    let currentLang = 'fr';

    function setLanguage(lang) {
      const trans = translations[lang];
      document.querySelectorAll('[data-lang-key]').forEach(el => {
        const key = el.dataset.langKey;
        if (trans[key]) {
          el.textContent = trans[key];
        }
      });
      currentLang = lang;
      langSwitcher.textContent = lang === 'fr' ? 'EN' : 'FR';
      document.documentElement.lang = lang;
    }

    langSwitcher.addEventListener('click', () => {
      const newLang = currentLang === 'fr' ? 'en' : 'fr';
      setLanguage(newLang);
    });

  })();
  </script>

  <script>
  (function() {
    // Cookie Consent Banner
    const banner = document.getElementById('cookie-banner');
    const acceptBtn = document.getElementById('cookie-accept-btn');
    const cookieConsentKey = 'kodikids_cookie_consent';

    if (!localStorage.getItem(cookieConsentKey)) {
      banner.style.display = 'flex';
    }

    acceptBtn.addEventListener('click', () => {
      localStorage.setItem(cookieConsentKey, 'true');
      banner.style.display = 'none';
    });
  })();
  </script>
</body>
</html>